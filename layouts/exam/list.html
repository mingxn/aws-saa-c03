{{ define "main" }}
<div class="container exam-setup">
    <h1>{{ .Title }}</h1>

    {{ .Content }}

    <div class="exam-config">
        <h2>Configure Your Exam</h2>

        <p class="exam-description">
            Simulate real exam conditions with a countdown timer and no immediate feedback until submission.
        </p>

        <div id="resume-section" class="resume-exam" style="display: none;">
            <div class="alert alert-info">
                <strong>Incomplete Exam Found</strong>
                <p id="resume-details"></p>
                <button id="resume-exam-btn" class="btn btn-secondary">Resume Exam</button>
                <button id="discard-exam-btn" class="btn btn-outline">Start New Exam</button>
            </div>
        </div>

        <div class="config-section">
            <label for="question-count">Number of Questions</label>
            <select id="question-count">
                <option value="10">10 Questions</option>
                <option value="20">20 Questions</option>
                <option value="30">30 Questions</option>
                <option value="50">50 Questions</option>
                <option value="65" selected>65 Questions (Full Exam)</option>
            </select>
        </div>

        <div class="config-section">
            <label for="time-limit">Time Limit</label>
            <select id="time-limit">
                <option value="30">30 Minutes (Quick Test)</option>
                <option value="60">60 Minutes</option>
                <option value="90">90 Minutes</option>
                <option value="130" selected>130 Minutes (Full Exam)</option>
                <option value="180">180 Minutes (Extended)</option>
            </select>
        </div>

        <div class="available-questions">
            <p id="available-count">Loading available questions...</p>
        </div>

        <button id="start-exam-btn" class="btn btn-primary">Start Exam</button>
    </div>

    <div class="exam-history">
        <h2>Exam History</h2>
        <div id="history-list"></div>
    </div>
</div>

<!-- Embed all questions as JSON for JavaScript -->
<script>
window.allQuestions = [
    {{ range where .Site.AllPages "Section" "questions" }}
    {
        title: {{ .Title | jsonify }},
        url: {{ .RelPermalink | jsonify }},
        question: {{ .Params.question | jsonify }},
        options: {{ .Params.options | jsonify }},
        answer: {{ .Params.answer | jsonify }},
        explanation: {{ .Params.explanation | jsonify }},
        categories: {{ .Params.categories | jsonify }},
        domain: {{ .Params.domain | jsonify }},
        difficulty: {{ .Params.difficulty | jsonify }}
    },
    {{ end }}
];
</script>
<script src="{{ "js/exam-setup.js" | relURL }}"></script>
{{ end }}
